<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jiro Amato">
<meta name="dcterms.date" content="2026-01-17">

<title>What Your Pharmacy Shelves Won’t Tell You About Hair Loss Treatment – Jiro's World</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-e31584831b205ffbb2d98406f31c2a5b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Jiro’s World</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-problem-too-many-treatments-not-enough-comparisons" id="toc-the-problem-too-many-treatments-not-enough-comparisons" class="nav-link active" data-scroll-target="#the-problem-too-many-treatments-not-enough-comparisons">The Problem: Too Many Treatments, Not Enough Comparisons</a></li>
  <li><a href="#indirect-comparisons-through-a-common-reference" id="toc-indirect-comparisons-through-a-common-reference" class="nav-link" data-scroll-target="#indirect-comparisons-through-a-common-reference">Indirect Comparisons Through a Common Reference</a></li>
  <li><a href="#building-out-the-network" id="toc-building-out-the-network" class="nav-link" data-scroll-target="#building-out-the-network">Building Out the Network</a></li>
  <li><a href="#case-study-ranking-hair-loss-treatments" id="toc-case-study-ranking-hair-loss-treatments" class="nav-link" data-scroll-target="#case-study-ranking-hair-loss-treatments">Case Study: Ranking Hair Loss Treatments</a></li>
  <li><a href="#under-the-hood" id="toc-under-the-hood" class="nav-link" data-scroll-target="#under-the-hood">Under the Hood</a></li>
  <li><a href="#why-this-matters" id="toc-why-this-matters" class="nav-link" data-scroll-target="#why-this-matters">Why This Matters</a></li>
  <li><a href="#the-limitations" id="toc-the-limitations" class="nav-link" data-scroll-target="#the-limitations">The Limitations</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">What Your Pharmacy Shelves Won’t Tell You About Hair Loss Treatment</h1>
<p class="subtitle lead">A Data Science Approach to Comparing Treatments with Network Meta-Analysis</p>
  <div class="quarto-categories">
    <div class="quarto-category">data science</div>
    <div class="quarto-category">statistics</div>
    <div class="quarto-category">network meta-analysis</div>
    <div class="quarto-category">health</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jiro Amato </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 17, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="the-problem-too-many-treatments-not-enough-comparisons" class="level2">
<h2 class="anchored" data-anchor-id="the-problem-too-many-treatments-not-enough-comparisons">The Problem: Too Many Treatments, Not Enough Comparisons</h2>
<p>Imagine that you are experiencing hair loss and you want to do something about it. You go online and find three main options for treatment. Minoxidil (commonly known as Rogaine), finasteride and dutasteride. Each one has studies showing it beats a placebo. Great. But which one actually works <em>best</em>?</p>
<p>The frustrating part for the consumer is that most clinical trials only test one treatment against a placebo. Sometimes they’ll compare two treatments directly. But running trials that compare every possible pair? That’s expensive, takes time and as more treatments hit the market, it becomes basically impossible.</p>
<p>So how do researchers figure out which treatment ranks first when they’ve never been directly compared?</p>
<p>That’s where <strong>network meta-analysis</strong> (NMA) comes in.</p>
</section>
<section id="indirect-comparisons-through-a-common-reference" class="level2">
<h2 class="anchored" data-anchor-id="indirect-comparisons-through-a-common-reference">Indirect Comparisons Through a Common Reference</h2>
<p>Network meta-analysis is built on a simple idea. If we know how <em>Treatment A</em> compares to a placebo, and how <em>Treatment B</em> compares to that same placebo, we can estimate how <em>A</em> and <em>B</em> compare to each other.</p>
<p>Let’s make this concrete with numbers.</p>
<p>Suppose <em>Study 1</em> finds that finasteride increases hair count by 15 hairs/cm² compared to placebo and <em>Study 2</em> finds that minoxidil increases hair count by 12 hairs/cm² compared to placebo.</p>
<p>In this case, finasteride and minoxidil were never tested head-to-head. However, we can still infer that finasteride is roughly 3 hairs/cm² more effective (15 - 12 = 3).</p>
<p>This is called an <strong>indirect comparison</strong>. The placebo serves as the <strong>common comparator</strong> which acts as the bridge connecting the two treatments.</p>
</section>
<section id="building-out-the-network" class="level2">
<h2 class="anchored" data-anchor-id="building-out-the-network">Building Out the Network</h2>
<p>The real power of NMA comes when we have many treatments and many studies. You can picture all the evidence as a network. Each treatment is a <strong>node</strong>, including placebo. Each line (<strong>edge</strong>) between nodes represents studies that directly compared those two treatments (<strong>direct comparison</strong>).</p>
<p>The magic of NMA is that it synthesizes all available evidence into a coherent framework. Even if Treatment X and Treatment Y were never tested against each other, we can estimate their relative effectiveness through their shared connections to other treatments in the network.</p>
<div id="cell-fig-network" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> nx.Graph()</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Nodes</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>treatments <span class="op">=</span> [</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Placebo"</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Minoxidil 2%</span><span class="ch">\n</span><span class="st">(topical)"</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Minoxidil 5%</span><span class="ch">\n</span><span class="st">(topical)"</span>,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Minoxidil 0.25mg</span><span class="ch">\n</span><span class="st">(oral)"</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Minoxidil 5mg</span><span class="ch">\n</span><span class="st">(oral)"</span>,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Finasteride 1mg</span><span class="ch">\n</span><span class="st">(oral)"</span>,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Finasteride 5mg</span><span class="ch">\n</span><span class="st">(oral)"</span>,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Dutasteride 0.5mg</span><span class="ch">\n</span><span class="st">(oral)"</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>G.add_nodes_from(treatments)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Edges</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>edges <span class="op">=</span> [</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"Placebo"</span>, <span class="st">"Minoxidil 2%</span><span class="ch">\n</span><span class="st">(topical)"</span>, <span class="dv">6</span>),</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"Placebo"</span>, <span class="st">"Minoxidil 5%</span><span class="ch">\n</span><span class="st">(topical)"</span>, <span class="dv">2</span>),</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"Placebo"</span>, <span class="st">"Finasteride 1mg</span><span class="ch">\n</span><span class="st">(oral)"</span>, <span class="dv">4</span>),</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"Placebo"</span>, <span class="st">"Finasteride 5mg</span><span class="ch">\n</span><span class="st">(oral)"</span>, <span class="dv">1</span>),</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"Placebo"</span>, <span class="st">"Dutasteride 0.5mg</span><span class="ch">\n</span><span class="st">(oral)"</span>, <span class="dv">2</span>),</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"Minoxidil 2%</span><span class="ch">\n</span><span class="st">(topical)"</span>, <span class="st">"Minoxidil 5%</span><span class="ch">\n</span><span class="st">(topical)"</span>, <span class="dv">2</span>),</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"Minoxidil 2%</span><span class="ch">\n</span><span class="st">(topical)"</span>, <span class="st">"Finasteride 1mg</span><span class="ch">\n</span><span class="st">(oral)"</span>, <span class="dv">1</span>),</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"Finasteride 1mg</span><span class="ch">\n</span><span class="st">(oral)"</span>, <span class="st">"Finasteride 5mg</span><span class="ch">\n</span><span class="st">(oral)"</span>, <span class="dv">1</span>),</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"Finasteride 1mg</span><span class="ch">\n</span><span class="st">(oral)"</span>, <span class="st">"Dutasteride 0.5mg</span><span class="ch">\n</span><span class="st">(oral)"</span>, <span class="dv">2</span>),</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"Minoxidil 0.25mg</span><span class="ch">\n</span><span class="st">(oral)"</span>, <span class="st">"Placebo"</span>, <span class="dv">1</span>),</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"Minoxidil 5mg</span><span class="ch">\n</span><span class="st">(oral)"</span>, <span class="st">"Placebo"</span>, <span class="dv">1</span>),</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>G.add_weighted_edges_from(edges)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>pos <span class="op">=</span> nx.spring_layout(G, k<span class="op">=</span><span class="dv">2</span>, iterations<span class="op">=</span><span class="dv">50</span>, seed<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>node_sizes <span class="op">=</span> [<span class="dv">800</span> <span class="op">+</span> <span class="dv">400</span> <span class="op">*</span> G.degree(node) <span class="cf">for</span> node <span class="kw">in</span> G.nodes()]</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>color_map <span class="op">=</span> []</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> node <span class="kw">in</span> G.nodes():</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"Placebo"</span> <span class="kw">in</span> node:</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>        color_map.append(<span class="st">"#95a5a6"</span>)  <span class="co"># Gray for placebo</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="st">"Dutasteride"</span> <span class="kw">in</span> node:</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>        color_map.append(<span class="st">"#e74c3c"</span>)  <span class="co"># Red for dutasteride</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="st">"Finasteride"</span> <span class="kw">in</span> node:</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>        color_map.append(<span class="st">"#3498db"</span>)  <span class="co"># Blue for finasteride</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>        color_map.append(<span class="st">"#2ecc71"</span>)  <span class="co"># Green for minoxidil</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>edge_weights <span class="op">=</span> [G[u][v][<span class="st">'weight'</span>] <span class="op">*</span> <span class="fl">1.5</span> <span class="cf">for</span> u, v <span class="kw">in</span> G.edges()]</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>nx.draw_networkx_edges(G, pos, width<span class="op">=</span>edge_weights, alpha<span class="op">=</span><span class="fl">0.6</span>, edge_color<span class="op">=</span><span class="st">"#7f8c8d"</span>)</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>nx.draw_networkx_nodes(G, pos, node_color<span class="op">=</span>color_map, node_size<span class="op">=</span>node_sizes, alpha<span class="op">=</span><span class="fl">0.9</span>)</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>nx.draw_networkx_labels(G, pos, font_size<span class="op">=</span><span class="dv">8</span>, font_weight<span class="op">=</span><span class="st">"bold"</span>)</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>legend_elements <span class="op">=</span> [</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>    plt.scatter([], [], c<span class="op">=</span><span class="st">"#95a5a6"</span>, s<span class="op">=</span><span class="dv">150</span>, label<span class="op">=</span><span class="st">"Placebo"</span>),</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>    plt.scatter([], [], c<span class="op">=</span><span class="st">"#e74c3c"</span>, s<span class="op">=</span><span class="dv">150</span>, label<span class="op">=</span><span class="st">"Dutasteride"</span>),</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>    plt.scatter([], [], c<span class="op">=</span><span class="st">"#3498db"</span>, s<span class="op">=</span><span class="dv">150</span>, label<span class="op">=</span><span class="st">"Finasteride"</span>),</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>    plt.scatter([], [], c<span class="op">=</span><span class="st">"#2ecc71"</span>, s<span class="op">=</span><span class="dv">150</span>, label<span class="op">=</span><span class="st">"Minoxidil"</span>)</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>ax.legend(handles<span class="op">=</span>legend_elements, loc<span class="op">=</span><span class="st">"upper left"</span>, title<span class="op">=</span><span class="st">"Treatment Type"</span>)</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"Network of Hair Loss Treatment Comparisons</span><span class="ch">\n</span><span class="st">(Gupta et al. 2022)"</span>,</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">"bold"</span>)</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>ax.axis(<span class="st">"off"</span>)</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-network" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-network-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-network-output-1.png" width="758" height="564" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-network-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Network of treatment comparisons from the Gupta et al.&nbsp;2022 study. Each node represents a treatment, and edges connect treatments that were directly compared in clinical trials. Node size reflects the number of studies involving that treatment, and edge thickness represents the number of direct comparisons.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The figure above shows the network from the Gupta study. Notice how placebo sits at the center, connecting to most treatments. This is typical since many trials compare a new treatment against placebo. The lines between treatments represent direct head-to-head comparisons from clinical trials.</p>
<p>Sometimes researchers have both direct evidence and indirect evidence for the same comparison. NMA combines them mathematically to get the most precise estimate possible. This combination of direct and indirect evidence is called <strong>mixed treatment comparison</strong>.</p>
<p>Mixed treatment comparison uses weighted averages. Larger sampled studies with less variability contribute more to the final estmation. Most modern NMA uses Bayesian statistics to quantify uncertainty and provide an estimation. This allows researchers to say things like “there’s a 96% chance <em>Treatment A</em> is the most effective.”.</p>
</section>
<section id="case-study-ranking-hair-loss-treatments" class="level2">
<h2 class="anchored" data-anchor-id="case-study-ranking-hair-loss-treatments">Case Study: Ranking Hair Loss Treatments</h2>
<p>In 2022, Gupta and colleagues published a NMA in <em>JAMA Dermatology</em> <span class="citation" data-cites="gupta2022">(<a href="#ref-gupta2022" role="doc-biblioref">Gupta et al. 2022</a>)</span>. They wanted to answer exactly this question, “Among minoxidil, finasteride, and dutasteride, which works best for male pattern hair loss?”.</p>
<p>They took data from 23 clinical trials spanning several decades. The studies looked at different doses and formulations of the following treatments:</p>
<ul>
<li>Oral dutasteride at 0.5 mg/day</li>
<li>Oral finasteride at 1 mg/day and 5 mg/day</li>
<li>Topical minoxidil in 2% and 5% solutions</li>
<li>Oral minoxidil at 0.25 mg/day and 5 mg/day</li>
<li>Placebo</li>
</ul>
<p>Most studies compared a single treatment to placebo and only a few went head-to-head. By connecting all the studies through the network, the researchers could rank all treatments at once.</p>
<p>The results were clear. At 24 weeks, oral dutasteride (0.5 mg/day) came out on top. It had a SUCRA score of 96%. Then oral finasteride 5 mg at 88%. Topical minoxidil 5% at 80%. Oral finasteride 1 mg at 65%.</p>
<div id="cell-fig-sucra-ranking" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> altair <span class="im">as</span> alt</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># SUCRA values from Gupta et al. 2022, Figure 3 (Column A: Total hair count at 24 weeks)</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Treatment'</span>: [</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Dutasteride 0.5mg (oral)'</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Finasteride 5mg (oral)'</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Minoxidil 5% (topical)'</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Finasteride 1mg (oral)'</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Minoxidil 2% (topical)'</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Minoxidil 5mg (oral)'</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Placebo'</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Minoxidil 0.25mg (oral)'</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SUCRA'</span>: [<span class="fl">95.7</span>, <span class="fl">87.8</span>, <span class="fl">80.4</span>, <span class="fl">65.2</span>, <span class="fl">55.3</span>, <span class="fl">29.6</span>, <span class="fl">13.5</span>, <span class="fl">8.4</span>]</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>chart <span class="op">=</span> alt.Chart(data).mark_bar().encode(</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>alt.X(<span class="st">'SUCRA:Q'</span>, title<span class="op">=</span><span class="st">'SUCRA Value (%)'</span>, scale<span class="op">=</span>alt.Scale(domain<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">100</span>])),</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>alt.Y(<span class="st">'Treatment:N'</span>, sort<span class="op">=</span><span class="st">'-x'</span>, title<span class="op">=</span><span class="va">None</span>),</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span>alt.Color(<span class="st">'SUCRA:Q'</span>, scale<span class="op">=</span>alt.Scale(scheme<span class="op">=</span><span class="st">'viridis'</span>), legend<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>).properties(</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Efficacy Ranking of Hair Loss Treatments (Gupta et al. 2022)'</span>,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    width<span class="op">=</span><span class="st">'container'</span>,</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">280</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>chart</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div id="fig-sucra-ranking" class="cell-output cell-output-display quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="2">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sucra-ranking-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">

<style>
  #altair-viz-2159873d68d74d40b648735484a636eb.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-2159873d68d74d40b648735484a636eb.vega-embed details,
  #altair-viz-2159873d68d74d40b648735484a636eb.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-2159873d68d74d40b648735484a636eb"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-2159873d68d74d40b648735484a636eb") {
      outputDiv = document.getElementById("altair-viz-2159873d68d74d40b648735484a636eb");
    }

    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@6?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@6.1.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@7?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      let deps = ["vega-embed"];
      require(deps, displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "6")
        .then(() => maybeLoadScript("vega-lite", "6.1.0"))
        .then(() => maybeLoadScript("vega-embed", "7"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-3a74f492d9152e263dfe7b29321e3ba1"}, "mark": {"type": "bar"}, "encoding": {"color": {"field": "SUCRA", "legend": null, "scale": {"scheme": "viridis"}, "type": "quantitative"}, "x": {"field": "SUCRA", "scale": {"domain": [0, 100]}, "title": "SUCRA Value (%)", "type": "quantitative"}, "y": {"field": "Treatment", "sort": "-x", "title": null, "type": "nominal"}}, "height": 280, "title": "Efficacy Ranking of Hair Loss Treatments (Gupta et al. 2022)", "width": "container", "$schema": "https://vega.github.io/schema/vega-lite/v6.1.0.json", "datasets": {"data-3a74f492d9152e263dfe7b29321e3ba1": [{"Treatment": "Dutasteride 0.5mg (oral)", "SUCRA": 95.7}, {"Treatment": "Finasteride 5mg (oral)", "SUCRA": 87.8}, {"Treatment": "Minoxidil 5% (topical)", "SUCRA": 80.4}, {"Treatment": "Finasteride 1mg (oral)", "SUCRA": 65.2}, {"Treatment": "Minoxidil 2% (topical)", "SUCRA": 55.3}, {"Treatment": "Minoxidil 5mg (oral)", "SUCRA": 29.6}, {"Treatment": "Placebo", "SUCRA": 13.5}, {"Treatment": "Minoxidil 0.25mg (oral)", "SUCRA": 8.4}]}}, {"mode": "vega-lite"});
</script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sucra-ranking-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: SUCRA rankings for hair loss treatments at 24 weeks (total hair count). Higher values indicate greater probability of being the most effective treatment. Data from Gupta et al.&nbsp;2022.
</figcaption>
</figure>
</div>
</div>
</section>
<section id="under-the-hood" class="level2">
<h2 class="anchored" data-anchor-id="under-the-hood">Under the Hood</h2>
<p>At its core, NMA relies on the <strong>consistency assumption</strong> which states that the indirect estimate should match up with the direct estimate when you have both available.</p>
<p>Suppose, Study 1 shows A beats placebo by 10 units. Study 2 shows B beats placebo by 6 units. The indirect math says A beats B by 4 units. If a third study directly compares A and B and finds A wins by 4 units, we’ve got consistency.</p>
<p>Here’s roughly how the statistical model works.</p>
<p>First, you <strong>define treatment effects</strong>. Each treatment gets an effect estimate relative to a common reference, usually placebo.</p>
<p>Then, you <strong>combine direct and indirect evidence</strong>. When both exist for a comparison, they get combined using inverse-variance weighting. More precise estimates from larger studies carry more weight.</p>
<p>Next, you <strong>estimate uncertainty</strong>. Bayesian methods give you not just point estimates but full probability distributions. So you know how confident to be in each ranking.</p>
<p>Finally, you <strong>rank the treatments</strong>. There’s a metric called <strong>SUCRA</strong>, Surface Under the Cumulative Ranking Curve. It summarizes the probability that each treatment is best, second-best, third-best, and so on. A SUCRA of 100% means the treatment is definitely best and 0% means it’s definitely worst.</p>
<p>The Gupta study ran 200,000 iterations of Markov Chain Monte Carlo sampling. That’s a lot of computation to make sure the results were stable.</p>
</section>
<section id="why-this-matters" class="level2">
<h2 class="anchored" data-anchor-id="why-this-matters">Why This Matters</h2>
<p>Think about someone standing in a pharmacy. They’re staring at the hair loss products. They want to know which one to buy.</p>
<p>Network meta-analysis gives them something real. A <strong>ranking based on all available evidence</strong>. Not marketing. Not one cherry-picked study.</p>
<p>Before this analysis, you might read one study showing finasteride works. Another showing minoxidil works. And you’d have no way to compare them. The NMA pulls together decades of clinical research into a clear order.</p>
<ol type="1">
<li>Dutasteride 0.5 mg/day (most effective)</li>
<li>Finasteride 5 mg/day</li>
<li>Oral minoxidil 5 mg/day</li>
<li>Finasteride 1 mg/day (the FDA-approved dose)</li>
<li>Topical minoxidil 5%</li>
<li>Topical minoxidil 2%</li>
<li>Oral minoxidil 0.25 mg/day</li>
</ol>
<p>This ranking is useful for patients and doctors to make informed decisions. It also shows gaps in the evidence, for example, dutasteride’s long-term efficacy at 48 weeks was not well-studied. This gives researchers a clear direction for future research.</p>
</section>
<section id="the-limitations" class="level2">
<h2 class="anchored" data-anchor-id="the-limitations">The Limitations</h2>
<p>Network meta-analysis isn’t magic. It depends on some key assumptions holding up.</p>
<p><strong>Transitivity</strong>: The studies being combined need to be similar enough that indirect comparisons make sense. If Study 1 enrolled young patients and Study 2 enrolled elderly patients, comparing their results through a common placebo might mislead you.</p>
<p><strong>Consistency</strong>: When you have both direct and indirect evidence, they should roughly agree. Big inconsistencies suggest problems with assumptions.</p>
<p><strong>Publication bias</strong>: If negative studies never get published, your network only includes treatments that looked like they worked. That can inflate the effectiveness estimates.</p>
<p>The Gupta study dealt with these issues. They assessed study quality using the Cochrane risk-of-bias tool. They evaluated network-wide evidence quality using the CINeMA framework. Gupta found that the evidence quality ranged from low to moderate for most comparisons. This is a common finding in NMA which reflects the imperfect nature of real-world clinical evidence.</p>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>Network meta-analysis takes scattered clinical evidence and turns it into something useful. Rankings you can actually act on.</p>
<p>Treatments can be compared indirectly through common reference points. That lets us answer questions no single trial could handle such as, “Which of these many treatments is actually best?”.</p>
<p>For hair loss, Gupta’s 2022 analysis gave a clear answer, oral dutasteride leads with higher-dose finasteride coming in next with topical minoxidil trailing behind. This NMA study is not the final word. New head-to-head trials will come along, the network will grow and estimates will become more precise.</p>
<p>The next time you are facing a decision with multiple options and conflicting evidence, look for a network meta-analysis. It might cut through the noise and show you what the data actually says.</p>
</section>
<section id="references" class="level2">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-gupta2022" class="csl-entry" role="listitem">
Gupta, Aditya K., Maanasa Venkataraman, Mesbah Talukder, and Mary A. Bamimore. 2022. <span>“Relative Efficacy of Minoxidil and the 5-α Reductase Inhibitors in Androgenetic Alopecia Treatment of Male Patients: A Network Meta-Analysis.”</span> <em>JAMA Dermatology</em> 158 (3): 266–74. <a href="https://doi.org/10.1001/jamadermatol.2021.5743">https://doi.org/10.1001/jamadermatol.2021.5743</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>